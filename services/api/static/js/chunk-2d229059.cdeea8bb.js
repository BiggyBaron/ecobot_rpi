(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d229059"],{dc59:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("CRow",{staticClass:"clapans"},[n("CCol",{attrs:{md:"12"}},[n("CCard",[n("CCardHeader",[n("div",{staticClass:"d-flex aligin-items-center justify-content-between"},[n("span",[t._v("История Мастер Хаба: "+t._s(t.id))]),n("CButton",{staticClass:"ml-3",attrs:{color:"success"},on:{click:function(e){t.addCommentModal=!t.addCommentModal}}},[t._v(" Добавить комметарий Хаба ")]),n("CButton",{staticClass:"mr-2",attrs:{color:"success"},on:{click:t.downloadArray}},[t._v(" Скачать историю Мастер Хаба в csv ")])],1)]),n("CCardBody",[n("CDataTable",{staticClass:"mb-0 table-outline",attrs:{hover:"",items:t.tableItems,fields:t.tableFields,"head-color":"light"},scopedSlots:t._u([{key:"select",fn:function(e){var a=e.item;return n("td",{},[n("CInputCheckbox",{attrs:{value:a.select,custom:"",inline:""},on:{change:function(e){t.isSelect=!0}}})],1)}},{key:"city",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.city)+" ")])}},{key:"district",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.district)+" ")])}},{key:"street",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.street)+" ")])}},{key:"building",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.typeofbuilding)+" ")])}},{key:"numHouse",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.buildingnum)+" ")])}},{key:"numDoor",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.entrancenum)+" ")])}},{key:"numMine",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.shaftnum)+" ")])}},{key:"stage",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.floor)+" ")])}},{key:"numOffice",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.aptoroffice)+" ")])}},{key:"id",fn:function(e){var a=e.item;return n("td",{},[t._v(" "+t._s(a.valveID)+" ")])}},{key:"status",fn:function(e){var a=e.item;return n("td",{},[0==a.status?n("CBadge",{attrs:{color:"danger"}},[t._v(" выключен ")]):1==a.status?n("CBadge",{attrs:{color:"success"}},[t._v("включен")]):2==a.status?n("CBadge",{attrs:{color:"warning"}},[t._v("нет данных")]):n("CBadge",{attrs:{color:"info"}},[t._v("не известно")]),n("br"),n("CSwitch",{staticClass:"mt-1",attrs:{color:"primary",checked:1==a.status,value:a.status},on:{"update:checked":[function(e){return t.$set(a,"status == 1",e)},function(e){return t.actionStatusChange(a)}]}})],1)}},{key:"settings",fn:function(e){e.item;return n("td",{},[n("span",{staticClass:"d-flex align-items-center",staticStyle:{"white-space":"nowrap",cursor:"pointer"},on:{click:function(e){t.warningModal=!t.warningModal}}},[n("CIcon",{staticClass:"mr-1",attrs:{name:"cilSettings"}}),t._v(" Настройки ")],1)])}}])})],1)],1)],1)],1),n("CModal",{attrs:{title:"Добавление комментария","ok-disabled":!0,show:t.addCommentModal},on:{"update:show":function(e){t.addCommentModal=e}}},[n("h4",[t._v("Введите комметарий")]),n("div",{staticClass:"mt-4"},[n("CTextarea",{attrs:{type:"text"},model:{value:t.commentary,callback:function(e){t.commentary=e},expression:"commentary"}})],1),n("div",[n("CButton",{staticClass:"mr-3",attrs:{disabled:!t.commentary,color:"success"},on:{click:t.sendCommentary}},[t._v("Отправить")])],1),n("div",{attrs:{slot:"footer"},slot:"footer"})])],1)},s=[],o=n("4375"),i=n("f236"),r=n("ed3a"),c=n("c08e"),u=n.n(c),d=n("4328"),l=n("bc3a"),m={name:"Master",components:{MainChartExample:o["a"],WidgetsDropdown:i["a"],WidgetsBrand:r["a"]},data:function(){return{addCommentModal:!1,commentary:"",warning:!1,success:!1,alert_message:"",warningModal:!1,isSelect:!1,action_switcher:"",id:this.$route.params.id,tableItems:[],tableFields:[{key:"masterhubID",label:"ID"},{key:"comment",label:"Комметарий"},{key:"date",label:"Дата"}]}},mounted:function(){this.getResults()},methods:{getResults:function(){var t=this;l.defaults.headers.common["Authorization"]="Bearer "+window.auth.token,l.get("/getmasterhubcommentsbyID/"+t.$route.params.id).then((function(e){t.tableItems=e.data;for(var n=0;n<t.tableItems.length;n++)t.tableItems[n].select=!1})).catch((function(t){401==t.response.status&&window.auth.logout()}))},downloadArray:function(){var t=this.tableItems,e=new Date,n="".concat(e.getDate(),"-").concat(e.getMonth()+1,"-").concat(e.getFullYear()),a="История клапана № "+this.id+"_"+n+".csv";u()(t,this.tableFields,a)},sendCommentary:function(){var t=this;l.defaults.headers.common["Authorization"]="Bearer "+window.auth.token,l({method:"post",url:"/addmasterhubcomment/",data:d.stringify({comment:this.commentary,ID:this.$route.params.id})}).then((function(){t.addCommentModal=!1,t.warningModal=!1,t.success=!0,t.alert_message="Успешно добавлено",t.getResults(),t.setting={},setTimeout((function(){this.success=!1}),3e3)})).catch((function(t){this.warning=!0,this.alert_message=t.response.data.detail,setTimeout((function(){this.warning=!1}),3e3)}))}}},f=m,v=n("2877"),h=Object(v["a"])(f,a,s,!1,null,null,null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d229059.cdeea8bb.js.map