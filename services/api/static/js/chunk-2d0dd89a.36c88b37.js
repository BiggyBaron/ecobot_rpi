(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0dd89a"],{"828b":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("CRow",{staticClass:"clapans"},[a("CCol",{attrs:{md:"12"}},[a("CCard",[a("CCardHeader",[a("div",{staticClass:"d-flex aligin-items-center justify-content-between"},[a("span",[t._v("История клапана: "+t._s(t.id))]),a("CButton",{staticClass:"ml-3",attrs:{color:"success"},on:{click:function(e){t.addCommentModal=!t.addCommentModal}}},[t._v(" Добавить комметарий клапана ")]),a("CButton",{staticClass:"ml-3",attrs:{color:"warning"},on:{click:function(e){t.addProblemModal=!t.addProblemModal}}},[t._v(" Указать проблему клапана ")]),a("CButton",{staticClass:"mr-2",attrs:{color:"success"},on:{click:t.downloadArray}},[t._v(" Скачать историю клапана в csv ")])],1)]),a("CCardBody",[a("CDataTable",{staticClass:"mb-0 table-outline",attrs:{hover:"",items:t.tableItems,fields:t.tableFields,"head-color":"light"},scopedSlots:t._u([{key:"select",fn:function(e){var n=e.item;return a("td",{},[a("CInputCheckbox",{attrs:{value:n.select,custom:"",inline:""},on:{change:function(e){t.isSelect=!0}}})],1)}},{key:"city",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.city)+" ")])}},{key:"district",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.district)+" ")])}},{key:"street",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.street)+" ")])}},{key:"building",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.typeofbuilding)+" ")])}},{key:"numHouse",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.buildingnum)+" ")])}},{key:"numDoor",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.entrancenum)+" ")])}},{key:"numMine",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.shaftnum)+" ")])}},{key:"stage",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.floor)+" ")])}},{key:"numOffice",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.aptoroffice)+" ")])}},{key:"id",fn:function(e){var n=e.item;return a("td",{},[t._v(" "+t._s(n.valveID)+" ")])}},{key:"status",fn:function(e){var n=e.item;return a("td",{},[0==n.status?a("CBadge",{attrs:{color:"danger"}},[t._v(" выключен ")]):1==n.status?a("CBadge",{attrs:{color:"success"}},[t._v("включен")]):2==n.status?a("CBadge",{attrs:{color:"warning"}},[t._v("нет данных")]):a("CBadge",{attrs:{color:"info"}},[t._v("не известно")]),a("br"),a("CSwitch",{staticClass:"mt-1",attrs:{color:"primary",checked:1==n.status,value:n.status},on:{"update:checked":[function(e){return t.$set(n,"status == 1",e)},function(e){return t.actionStatusChange(n)}]}})],1)}},{key:"settings",fn:function(e){var n=e.item;return a("td",{},[a("span",{staticClass:"d-flex align-items-center",staticStyle:{"white-space":"nowrap",cursor:"pointer"},on:{click:function(e){t.warningModal=!t.warningModal}}},[a("CIcon",{staticClass:"mr-1",attrs:{name:"cilSettings"}}),t._v(" Настройки ")],1),a("span",{staticClass:"d-flex align-items-center",staticStyle:{"white-space":"nowrap",cursor:"pointer"},on:{click:function(e){return t.$router.push({path:"/dashboard/"+n.id})}}},[a("CIcon",{staticClass:"mr-1",attrs:{name:"cilSettings"}}),t._v(" История ")],1)])}}])})],1)],1)],1)],1),a("CModal",{attrs:{title:"Добавление комментария","ok-disabled":!0,show:t.addCommentModal},on:{"update:show":function(e){t.addCommentModal=e}}},[a("h4",[t._v("Введите комметарий")]),a("div",{staticClass:"mt-4"},[a("CTextarea",{attrs:{type:"text",required:""},model:{value:t.commentary,callback:function(e){t.commentary=e},expression:"commentary"}})],1),a("div",[a("CButton",{staticClass:"mr-3",attrs:{disabled:!t.commentary,color:"success"},on:{click:t.sendCommentary}},[t._v("Отправить")])],1),a("div",{attrs:{slot:"footer"},slot:"footer"})]),a("CModal",{attrs:{title:"Добавление проблемы","ok-disabled":!0,show:t.addProblemModal},on:{"update:show":function(e){t.addProblemModal=e}}},[a("h4",[t._v("Сообщите о проблеме")]),a("div",{staticClass:"mt-4"},[a("CTextarea",{attrs:{type:"text",required:""},model:{value:t.problem,callback:function(e){t.problem=e},expression:"problem"}})],1),a("div",[a("CButton",{staticClass:"mr-3",attrs:{disabled:!t.problem,color:"success"},on:{click:t.sendProblem}},[t._v("Отправить")])],1),a("div",{attrs:{slot:"footer"},slot:"footer"})])],1)},s=[],o=a("4375"),r=a("f236"),i=a("ed3a"),c=a("c08e"),l=a.n(c),d=a("4328"),u=a("bc3a"),m={name:"Dashboard",components:{MainChartExample:o["a"],WidgetsDropdown:r["a"],WidgetsBrand:i["a"]},data:function(){return{addProblemModal:!1,problem:"",addCommentModal:!1,commentary:"",warning:!1,success:!1,alert_message:"",warningModal:!1,isSelect:!1,action_switcher:"",id:this.$route.params.id,tableItems:[],tableFields:[{key:"valveID",label:"ID"},{key:"comment",label:"Комметарий"},{key:"date",label:"Дата"}]}},mounted:function(){this.getResults()},methods:{getResults:function(){var t=this;u.defaults.headers.common["Authorization"]="Bearer "+window.auth.token,u.get("/getvalvecommentsbyID/"+t.$route.params.id).then((function(e){t.tableItems=e.data;for(var a=0;a<t.tableItems.length;a++)t.tableItems[a].select=!1})).catch((function(t){401==t.response.status&&window.auth.logout()}))},downloadArray:function(){var t=this.tableItems,e=new Date,a="".concat(e.getDate(),"-").concat(e.getMonth()+1,"-").concat(e.getFullYear()),n="История клапана № "+this.id+"_"+a+".csv";l()(t,this.tableFields,n)},sendCommentary:function(){var t=this;u.defaults.headers.common["Authorization"]="Bearer "+window.auth.token,u({method:"post",url:"/addvalvecomment/",data:d.stringify({comment:this.commentary,ID:this.$route.params.id})}).then((function(){t.addCommentModal=!1,t.commentary="",t.getResults(),app.warningModal=!1,app.success=!0,app.alert_message="Успешно добавлено",app.setting={},setTimeout((function(){app.success=!1}),3e3)})).catch((function(t){app.warning=!0,app.alert_message=t.response.data.detail,setTimeout((function(){app.warning=!1}),3e3)}))},sendProblem:function(){var t=this;u.defaults.headers.common["Authorization"]="Bearer "+window.auth.token,u({method:"post",url:"/sensorproblem/",data:d.stringify({problem_log:this.problem,valveID:this.$route.params.id})}).then((function(){t.addProblemModal=!1,t.problem="",t.getResults(),app.warningModal=!1,app.success=!0,app.alert_message="Успешно добавлено",app.setting={},setTimeout((function(){app.success=!1}),3e3)})).catch((function(t){app.warning=!0,app.alert_message=t.response.data.detail,setTimeout((function(){app.warning=!1}),3e3)}))}}},p=m,f=a("2877"),v=Object(f["a"])(p,n,s,!1,null,null,null);e["default"]=v.exports}}]);
//# sourceMappingURL=chunk-2d0dd89a.36c88b37.js.map